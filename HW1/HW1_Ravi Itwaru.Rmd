---
title: "Project 1"
author: ''
date: ''
output:
  pdf_document:
    toc: yes
  html_document:
    df_print: paged
    toc: yes
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(funModeling)
library(dplyr)
library(ggplot2)
library(scales)
library(dplyr)
library(knitr)
library(pander)
```

# Data Exploration
```{r, echo=FALSE}
```

# Data Preparation
```{r, echo=FALSE}
eva_data <- read.csv(file="moneyball-evaluation-data.csv", header=TRUE, sep=",")
train_data <- read.csv(file="moneyball-training-data.csv", header=TRUE, sep=",")
```

```{r, echo=FALSE}
eva_data_status <- df_status(eva_data)
eva_data_status[order(-eva_data_status$p_zeros),]

train_data_status <- df_status(train_data)
train_data_status[order(-train_data_status$p_na),]
```
```{r, echo=FALSE}
train_data$HBP_missing <- ifelse(is.na(train_data$TEAM_BATTING_HBP), 1, 0)
train_data$TEAM_BATTING_HBP[is.na(train_data$TEAM_BATTING_HBP)] <- mean(train_data$TEAM_BATTING_HBP, na.rm=TRUE)
```

```{r, echo=FALSE}
train_data$CS_missing <- ifelse(is.na(train_data$TEAM_BASERUN_CS), 1, 0)
train_data$TEAM_BASERUN_CS[is.na(train_data$TEAM_BASERUN_CS)] <- mean(train_data$TEAM_BASERUN_CS, na.rm=TRUE)
```

```{r, echo=FALSE}
train_data$DP_missing <- ifelse(is.na(train_data$TEAM_FIELDING_DP), 1, 0)
train_data$TEAM_FIELDING_DP[is.na(train_data$TEAM_FIELDING_DP)] <- mean(train_data$TEAM_FIELDING_DP, na.rm=TRUE)
```

```{r, echo=FALSE}
train_data$TEAM_BASERUN_SB[is.na(train_data$TEAM_BASERUN_SB)] <- mean(train_data$TEAM_BASERUN_SB, na.rm=TRUE)
train_data$TEAM_BATTING_SO[is.na(train_data$TEAM_BATTING_SO)] <- mean(train_data$TEAM_BATTING_SO, na.rm=TRUE)
train_data$TEAM_PITCHING_SO[is.na(train_data$TEAM_PITCHING_SO)] <- mean(train_data$TEAM_PITCHING_SO, na.rm=TRUE)
```

```{r, echo=FALSE}
df_status(train_data)
```

# Build Model

```{r, echo=FALSE, warning=FALSE}
#This model contains all the predictor variables from our training dataset. All significant and non-significan predictors are displayed in the regression model below:
# remove the index column from the train data.
train_data <- select(train_data, -c(INDEX))
model_all_predictors <- lm(TARGET_WINS ~., data = train_data)
#summary(model_all_predictors)
```

## Model 1

Model 1 is based on reviewing the p value from a model with all the predictors fitted. After reviewing the predictors that were statistically significant, a decission was made to fit this model with three statically significant predictors: TEAM_BATTING_H, TEAM_BASERUN_SB, and TEAM_FIELDING_E. The coefficients in this model tells us that there are  possitive coefficients for TEAM_BATTING_H (Base Hits by batters) and TEAM_BASERUN_SB (Stolen bases) which makes sense since both of ther predictors will cause target wins to go up. The predictor with negative coefficient is TEAM_FIELDING_E(errors) which will indeed cause your teams wins to go down. This model has an R^2 of 0.27 and the F-statistics is 284

```{r, echo=FALSE}
model1 <- lm(TARGET_WINS ~ (TEAM_BATTING_H + TEAM_BASERUN_SB + TEAM_FIELDING_E), data = train_data)
summary(model1)
pander(summary(model1))
```

The termplot below gives us a visual of the coefficients from model 1 agains the slopes of each of the predictors.

```{r, echo=FALSE}
termplot(model1, partial.resid = TRUE)
```

# R Code

```{r, echo=TRUE, eval=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60)}
#Data Preparation
eva_data <- read.csv(file="moneyball-evaluation-data.csv", header=TRUE, sep=",")
train_data <- read.csv(file="moneyball-training-data.csv", header=TRUE, sep=",")

eva_data_status <- df_status(eva_data)
eva_data_status[order(-eva_data_status$p_zeros),]

train_data_status <- df_status(train_data)
train_data_status[order(-train_data_status$p_na),]

train_data$HBP_missing <- ifelse(is.na(train_data$TEAM_BATTING_HBP), 1, 0)
train_data$TEAM_BATTING_HBP[is.na(train_data$TEAM_BATTING_HBP)] <- mean(train_data$TEAM_BATTING_HBP, na.rm=TRUE)

train_data$CS_missing <- ifelse(is.na(train_data$TEAM_BASERUN_CS), 1, 0)
train_data$TEAM_BASERUN_CS[is.na(train_data$TEAM_BASERUN_CS)] <- mean(train_data$TEAM_BASERUN_CS, na.rm=TRUE)

train_data$DP_missing <- ifelse(is.na(train_data$TEAM_FIELDING_DP), 1, 0)
train_data$TEAM_FIELDING_DP[is.na(train_data$TEAM_FIELDING_DP)] <- mean(train_data$TEAM_FIELDING_DP, na.rm=TRUE)

train_data$TEAM_BASERUN_SB[is.na(train_data$TEAM_BASERUN_SB)] <- mean(train_data$TEAM_BASERUN_SB, na.rm=TRUE)
train_data$TEAM_BATTING_SO[is.na(train_data$TEAM_BATTING_SO)] <- mean(train_data$TEAM_BATTING_SO, na.rm=TRUE)
train_data$TEAM_PITCHING_SO[is.na(train_data$TEAM_PITCHING_SO)] <- mean(train_data$TEAM_PITCHING_SO, na.rm=TRUE)

df_status(train_data)
```

```{r, echo=TRUE, eval=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60)}
# Build Model

#This model contains all the predictor variables from our training dataset. All significant and non-significan predictors are displayed in the regression model below:
# remove the index column from the train data.
train_data <- select(train_data, -c(INDEX))
model_all_predictors <- lm(TARGET_WINS ~., data = train_data)
summary(model_all_predictors)

## Model 1
model1 <- lm(TARGET_WINS ~ (TEAM_BATTING_H + TEAM_BASERUN_SB + TEAM_FIELDING_E), data = train_data)
summary(model1)
pander(summary(model1))
termplot(model1)
```

